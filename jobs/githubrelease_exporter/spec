---
name: githubrelease_exporter

templates:
  bin/githubrelease_exporter_ctl: bin/githubrelease_exporter_ctl
  config/config.yml: config/config.yml
  config/web_tls_cert.pem: config/web_tls_cert.pem
  config/web_tls_key.pem: config/web_tls_key.pem

packages:
 - githubrelease_exporter

properties:
  githubrelease_exporter.metrics.environment:
    description: "Environment label to be attached to metrics"
  githubrelease_exporter.metrics.namespace:
    description: "Metrics Namespace"
  githubrelease_exporter.log_format:
    description: "Set the log target and format. Example: 'logger:syslog?appname=bob&local=7' or 'logger:stdout?json=true'"
  githubrelease_exporter.log_level:
    description: "Only log messages with the given severity or above. Valid levels: [debug, info, warn, error, fatal]"
  githubrelease_exporter.web.port:
    description: "Port on which to expose web interface and telemetry"
    default: "9362"
  githubrelease_exporter.web.telemetry_path:
    description: "Path under which to expose Prometheus metrics"
  githubrelease_exporter.web.auth_username:
    description: "Username for web interface basic auth"
  githubrelease_exporter.web.auth_password:
    description: "Password for web interface basic auth"
  githubrelease_exporter.web.tls_cert:
    description: "TLS certificate (PEM format). If the certificate is signed by a certificate authority, the file should be the concatenation of the server's certificate, any intermediates, and the CA's certificate"
  githubrelease_exporter.web.tls_key:
    description: "TLS private key (PEM format)"
  env.http_proxy:
    description: "HTTP proxy to use"
  env.https_proxy:
    description: "HTTPS proxy to use"
  env.no_proxy:
    description: "List of comma-separated hosts that should skip connecting to the proxy"
  githubrelease_exporter.github-token:
    description: "Token to use to connect Github API (without which the exporter will quickly hit rate limiter)"
  githubrelease_exporter.bosh-deployment:
    description: ""
    default:
      cf:
        owner: cloudfoundry
        repo: cf-deployment
        manifest: cf-deployment.yml
        ops:
          - operations/use-haproxy.yml
          - operations/backup-and-restore/enable-backup-restore.yml
      concourse:
        types: [ "tag" ]
        owner: concourse
        repo: concourse-bosh-deployment
        manifest: cluster/concourse.yml
        vars:
          - versions.yml
      prometheus:
        owner: bosh-prometheus
        repo: prometheus-boshrelease
        manifest: manifests/prometheus.yml
        ops:
          - manifests/operators/enable-cf-route-registrar.yml
          - manifests/operators/use-sqlite3.yml
      bosh:
        owner: cloudfoundry
        repo: bosh-deployment
        manifest: bosh.yml
        ops:
          - vsphere/cpi.yml
          - uaa.yml
          - credhub.yml
          - bbr.yml
  githubrelease_exporter.github-release:
    description: ""
    default:
      terraform-provider-credhub:
        owner: orange-cloudfoundry
        repo: terraform-provider-credhub
      bbl:
        owner: cloudfoundry
        repo: bosh-bootloader
      bosh-cli:
        owner: cloudfoundry
        repo: bosh-cli
      stemcell:
        owner: cloudfoundry
        repo: bosh-linux-stemcell-builder
        format:
          match: "stable-([0-9+.]+)"
          replace: "${1}"
